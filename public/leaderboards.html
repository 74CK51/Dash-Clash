<!DOCTYPE html>
<html>
<head>
  <title>Leaderboards</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header style="display: flex; align-items: center; justify-content: space-between; padding: 10px 20px; background: #f7f7f7;">
    <div style="display: flex; align-items: center;">
      <a href="/" style="text-decoration: none;">
        <img src="images/dashclash_logo.png" alt="Logo" style="height: 60px; margin-right: 10px;">
      </a>
    </div>
    <nav style="display: flex; gap: 20px;">
      <a href="leaderboards.html" style="text-decoration: none; color: #333;">Leaderboards</a>
  <a href="http://www.strava.com/oauth/authorize?client_id=84396&response_type=code&redirect_uri=http://localhost:3000/exchange_token&scope=activity:read" class="connect-button">CONNECT</a>  </nav>
  </header>

  <div class="content-container">
  <div class="main-rectangle">


  <div class="leaderboard-titles">
    <div class="title-card">
      <div class="title-label">MILEAGE MAESTRO</div>
      <div class="title-winner" id="firstMileage"></div>
    </div>
    <div class="title-card">
      <div class="title-label">SPEED DEMON</div>
      <div class="title-winner" id="firstPace"></div>
    </div>
    <div class="title-card">
      <div class="title-label">STRAVA SPAMMER</div>
      <div class="title-winner" id="firstNumRuns"></div>
    </div>
  </div>

  <div class="select-row">
    <select id="weekSelect"></select>
    <select id="statSelect">
      <option value="mileage">Mileage</option>
      <option value="pace">Pace</option>
      <option value="numRuns">Number of Runs</option>
    </select>
  </div>

<div class="leaderboard-wrapper">
  <div class="leaderboard-header">
    <span class="place-col">Place</span>
    <span class="name-col">Name</span>
    <span class="stat-col" id="statHeader">Week 0 Mileage</span>
  </div>
  <div id="leaderboard"></div>
</div>
</div>
</div>

<script>
fetch('/weekRanges')
  .then(res => res.json())
  .then(weekRanges => {
    const weekSelect = document.getElementById('weekSelect');
    weekSelect.innerHTML = ''; // Clear any existing options

    // Get today's date
    const today = new Date();
    const weekNums = Object.keys(weekRanges).map(Number).sort((a, b) => a - b);

    // Always add "All Time" option
    const allTimeOption = document.createElement('option');
    allTimeOption.value = '';
    allTimeOption.textContent = 'All Time';
    weekSelect.appendChild(allTimeOption);

    // Add options for weeks that have started (start <= today)
    weekNums.forEach(weekNum => {
      const startDate = new Date(weekRanges[weekNum].start);
      if (today >= startDate) {
        const opt = document.createElement('option');
        opt.value = weekNum;
        opt.textContent = `Week ${weekNum}`;
        weekSelect.appendChild(opt);
      }
    });
  });
</script>

<script src="leaderboards.js"></script>
</body>
</html>